{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\MircoFiocchi\\\\Desktop\\\\BroadcastApp\\\\client\\\\src\\\\containers\\\\StreamView\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useParams } from 'react-router-dom';\nimport { useDispatch } from 'react-redux';\nimport { Auth_NicknameSelector, Auth_AccessTokenSelector } from '../Auth/selectors';\nimport { HOST, PARTICIPANT } from './constants';\nimport { StreamViewLayout, StreamViewerLayout } from './StreamViewStyles.elements';\nimport MediaSelector from '../MediaSelector';\nimport Red5Content from '../Red5Content';\nimport SubscribersList from '../SubscribersList';\nimport { App_WSConnectedSelector, App_WSConnectionID } from '../App/selectors';\nimport { AddViewer, viewerDisconnect } from '../App/actions';\nimport { StreamView_StartedSelector } from './selectors';\nimport { fetchStream } from './actions';\nexport default function StreamView() {\n  _s();\n\n  const nickname = useSelector(Auth_NicknameSelector);\n  const token = useSelector(Auth_AccessTokenSelector);\n  const WSConnected = useSelector(App_WSConnectedSelector);\n  const WSConnectionID = useSelector(App_WSConnectionID);\n  const hostConnected = useSelector(StreamView_StartedSelector);\n  const {\n    URLNickname\n  } = useParams();\n  const role = nickname === URLNickname ? HOST : PARTICIPANT;\n  const dispatch = useDispatch();\n  const dataInfo = useMemo(() => {\n    return token ? {\n      nickname: URLNickname,\n      token\n    } : {\n      nickname: URLNickname,\n      name: nickname + Math.floor(Math.random() * 0x10000).toString(16)\n    };\n  }, [token, URLNickname, nickname]);\n  useEffect(() => {\n    if (WSConnected) {\n      const publisher = role === HOST;\n      dispatch(AddViewer({\n        connectionId: WSConnectionID,\n        publisher: publisher,\n        ...dataInfo\n      }));\n    }\n  }, [dispatch, dataInfo, WSConnected, WSConnectionID, role]);\n  useEffect(() => {\n    if (role === PARTICIPANT) {\n      dispatch(fetchStream(URLNickname));\n    }\n  }, [dispatch, URLNickname, role]);\n  useEffect(() => {\n    return function () {\n      if (role === PARTICIPANT) {\n        dispatch(viewerDisconnect(dataInfo));\n      }\n    };\n  }, [dispatch, role, dataInfo]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: role === HOST ? /*#__PURE__*/_jsxDEV(StreamViewLayout, {\n      children: [role === HOST && /*#__PURE__*/_jsxDEV(MediaSelector, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 29\n      }, this), /*#__PURE__*/_jsxDEV(Red5Content, {\n        role: role,\n        nickname: URLNickname,\n        connected: hostConnected\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SubscribersList, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(StreamViewerLayout, {\n      children: [/*#__PURE__*/_jsxDEV(Red5Content, {\n        role: role,\n        nickname: URLNickname,\n        connected: hostConnected\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SubscribersList, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n\n_s(StreamView, \"My3Bocqz4OGgCMRin86NvcVYOP8=\", false, function () {\n  return [useSelector, useSelector, useSelector, useSelector, useSelector, useParams, useDispatch];\n});\n\n_c = StreamView;\n\nvar _c;\n\n$RefreshReg$(_c, \"StreamView\");","map":{"version":3,"sources":["C:/Users/MircoFiocchi/Desktop/BroadcastApp/client/src/containers/StreamView/index.js"],"names":["React","useEffect","useMemo","useSelector","useParams","useDispatch","Auth_NicknameSelector","Auth_AccessTokenSelector","HOST","PARTICIPANT","StreamViewLayout","StreamViewerLayout","MediaSelector","Red5Content","SubscribersList","App_WSConnectedSelector","App_WSConnectionID","AddViewer","viewerDisconnect","StreamView_StartedSelector","fetchStream","StreamView","nickname","token","WSConnected","WSConnectionID","hostConnected","URLNickname","role","dispatch","dataInfo","name","Math","floor","random","toString","publisher","connectionId"],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { useParams } from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\n\r\nimport {\r\n  Auth_NicknameSelector,\r\n  Auth_AccessTokenSelector,\r\n} from '../Auth/selectors';\r\nimport { HOST, PARTICIPANT } from './constants';\r\n\r\nimport {\r\n  StreamViewLayout,\r\n  StreamViewerLayout,\r\n} from './StreamViewStyles.elements';\r\nimport MediaSelector from '../MediaSelector';\r\nimport Red5Content from '../Red5Content';\r\nimport SubscribersList from '../SubscribersList';\r\nimport { App_WSConnectedSelector, App_WSConnectionID } from '../App/selectors';\r\n\r\nimport { AddViewer, viewerDisconnect } from '../App/actions';\r\nimport { StreamView_StartedSelector } from './selectors';\r\nimport { fetchStream } from './actions';\r\n\r\nexport default function StreamView() {\r\n  const nickname = useSelector(Auth_NicknameSelector);\r\n  const token = useSelector(Auth_AccessTokenSelector);\r\n  const WSConnected = useSelector(App_WSConnectedSelector);\r\n  const WSConnectionID = useSelector(App_WSConnectionID);\r\n  const hostConnected = useSelector(StreamView_StartedSelector);\r\n\r\n  const { URLNickname } = useParams();\r\n  const role = nickname === URLNickname ? HOST : PARTICIPANT;\r\n  const dispatch = useDispatch();\r\n\r\n  const dataInfo = useMemo(() => {\r\n    return token\r\n      ? { nickname: URLNickname, token }\r\n      : {\r\n          nickname: URLNickname,\r\n          name: nickname + Math.floor(Math.random() * 0x10000).toString(16),\r\n        };\r\n  }, [token, URLNickname, nickname]);\r\n\r\n  useEffect(() => {\r\n    if (WSConnected) {\r\n      const publisher = role === HOST;\r\n      dispatch(AddViewer({ connectionId: WSConnectionID, publisher: publisher, ...dataInfo }));\r\n    }\r\n  }, [dispatch, dataInfo, WSConnected, WSConnectionID, role]);\r\n\r\n  useEffect(() =>{\r\n      if(role === PARTICIPANT){\r\n        dispatch(fetchStream(URLNickname));\r\n      }\r\n  }, [dispatch, URLNickname, role]);\r\n\r\n  useEffect(() => {\r\n    return function(){\r\n      if(role === PARTICIPANT){\r\n        dispatch(viewerDisconnect(dataInfo));\r\n      }\r\n    }\r\n  }, [dispatch, role, dataInfo])\r\n\r\n  return (\r\n    <>\r\n      {role === HOST ? (\r\n        <StreamViewLayout>\r\n          {role === HOST && <MediaSelector />}\r\n          <Red5Content\r\n            role={role}\r\n            nickname={URLNickname}\r\n            connected={hostConnected}\r\n          />\r\n          <SubscribersList />\r\n        </StreamViewLayout>\r\n      ) : (\r\n        <StreamViewerLayout>\r\n          <Red5Content\r\n            role={role}\r\n            nickname={URLNickname}\r\n            connected={hostConnected}\r\n          />\r\n          <SubscribersList />\r\n        </StreamViewerLayout>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}